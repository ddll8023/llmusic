// 深色主题样式

@use "sass:color";
@use "../variables/_colors" as *;
@use "../variables/_typography" as *;
@use "../variables/_layout" as *;

// 主题类
.theme-dark {
    // 覆盖主题变量（如果需要动态切换主题）
    --bg-primary: #{$bg-primary};
    --bg-secondary: #{$bg-secondary};
    --bg-tertiary: #{$bg-tertiary};
    --text-primary: #{$text-primary};
    --text-secondary: #{$text-secondary};
    --accent-color: #{$accent-green};

    // 特殊组件样式
    .sidebar {
        background: linear-gradient(180deg, $bg-secondary 0%, color.adjust($bg-secondary, $lightness: -3%) 100%);
        border-right: 1px solid $bg-tertiary;

        .sidebar-header {
            background-color: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid $bg-tertiary;
        }
    }

    .player-bar {
        background: linear-gradient(180deg, color.adjust($bg-secondary, $lightness: 2%) 0%, $bg-secondary 100%);
        border-top: 1px solid $bg-tertiary;
        backdrop-filter: blur(10px);
    }

    .title-bar {
        background-color: color.adjust($bg-primary, $lightness: -2%);
        border-bottom: 1px solid $bg-tertiary;

        &.is-electron {
            -webkit-app-region: drag;

            .window-controls {
                -webkit-app-region: no-drag;
            }
        }
    }

    // 歌词页面特殊样式
    .lyric-page {
        background: linear-gradient(135deg, color.adjust($bg-primary, $lightness: -2%) 0%, $bg-primary 50%, color.adjust($bg-secondary, $lightness: -2%) 100%);

        .lyric-background {
            &::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: radial-gradient(ellipse at center,
                        rgba(76, 175, 80, 0.1) 0%,
                        rgba(76, 175, 80, 0.05) 30%,
                        transparent 70%);
                pointer-events: none;
            }
        }

        .lyric-line {
            &.active {
                color: $accent-green;
                text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
            }
        }
    }

    // 进度条样式
    .progress-bar {
        background-color: $bg-tertiary;
        border-radius: 2px;
        overflow: hidden;

        .progress-fill {
            background: linear-gradient(90deg, $accent-green 0%, $accent-hover 100%);
            box-shadow: 0 0 8px rgba(76, 175, 80, 0.3);
        }

        .progress-thumb {
            background-color: $accent-green;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.4);

            &:hover {
                box-shadow: 0 0 12px rgba(76, 175, 80, 0.6);
            }
        }
    }

    // 音量控制样式
    .volume-control {
        .volume-slider {
            background-color: $bg-tertiary;

            &::-webkit-slider-thumb {
                background: linear-gradient(135deg, $accent-green 0%, $accent-hover 100%);
                box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
            }

            &::-webkit-slider-track {
                background: linear-gradient(90deg, $accent-green 0%, $bg-tertiary var(--volume-percent, 50%), $bg-tertiary 100%);
            }
        }
    }

    // 搜索框特殊样式
    .search-box {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);

        &:focus {
            background-color: rgba(255, 255, 255, 0.08);
            border-color: $accent-green;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.2);
        }
    }

    // 上下文菜单
    .context-menu {
        background-color: rgba(24, 24, 24, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);

        .menu-item {
            &:hover {
                background-color: rgba(76, 175, 80, 0.1);
            }
        }
    }

    // 模态框
    .modal {
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: $bg-secondary;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 16px 64px rgba(0, 0, 0, 0.5);
        }
    }

    // 通知样式
    .notification {
        background-color: rgba(24, 24, 24, 0.95);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);

        &.notification--success {
            border-left: 4px solid $success;
        }

        &.notification--error {
            border-left: 4px solid $danger;
        }

        &.notification--warning {
            border-left: 4px solid $warning;
        }

        &.notification--info {
            border-left: 4px solid $info;
        }
    }

    // 加载状态
    .loading-overlay {
        background-color: rgba(18, 18, 18, 0.8);
        backdrop-filter: blur(5px);

        .loading-spinner {
            border-color: rgba(76, 175, 80, 0.2);
            border-top-color: $accent-green;
        }
    }

    // 歌曲表格
    .song-table {
        thead {
            background-color: rgba(255, 255, 255, 0.02);
            border-bottom: 1px solid $bg-tertiary;

            th {
                color: $text-secondary;
                font-weight: $font-weight-medium;
            }
        }

        tbody tr {
            &:nth-child(even) {
                background-color: rgba(255, 255, 255, 0.02);
            }

            &:hover {
                background-color: rgba(255, 255, 255, 0.05);
            }

            &.is-current {
                background-color: rgba(76, 175, 80, 0.1);
            }
        }
    }

    // 播放列表项
    .playlist-item {
        background-color: $bg-secondary;
        border: 1px solid transparent;

        &:hover {
            border-color: rgba(255, 255, 255, 0.1);
            background-color: color.adjust($bg-secondary, $lightness: 2%);
        }

        &.is-active {
            border-color: $accent-green;
            background-color: rgba(76, 175, 80, 0.1);
        }
    }
}

// 确保在深色模式下的特殊处理
@media (prefers-color-scheme: dark) {
    :root {
        color-scheme: dark;
    }

    // 浏览器原生元素适配
    input[type="range"] {
        &::-webkit-slider-track {
            background-color: $bg-tertiary;
        }

        &::-webkit-slider-thumb {
            background-color: $accent-green;
        }
    }

    select,
    option {
        background-color: $bg-secondary;
        color: $text-primary;
        border-color: $bg-tertiary;
    }
}