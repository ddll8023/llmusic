# LLMusic 样式规范文档

本文档定义 LLMusic 项目的样式编写规范，包括色彩、布局、组件、图标等方面的标准，为开发者提供统一的样式编写指导。

## 规范概览

- **色彩系统**：统一的深色主题色彩规范
- **布局系统**：基于 CSS Grid 和变量的响应式布局
- **组件规范**：可复用的样式类和组件编写标准
- **图标规范**：Font Awesome 4.7.0 图标使用标准
- **动画规范**：统一的过渡效果和动画定义
- **响应式规范**：断点和适配规则
- **文件组织**：SCSS 文件结构和导入规范

## 1. 主题色彩系统

### 背景色

```scss
$bg-primary: #121212; // 主背景色
$bg-secondary: #181818; // 次级背景色
$bg-tertiary: #282828; // 三级背景色(边框、分割线)
```

### 文本色

```scss
$text-primary: #ffffff; // 主文本色
$text-secondary: #b3b3b3; // 次级文本色
$text-disabled: #535353; // 禁用文本色
```

### 功能色

```scss
$accent-green: #4caf50; // 主要强调色
$accent-hover: #66bb6a; // 悬停状态
$danger: #f44336; // 危险操作
$warning: #ff9800; // 警告提示
```

### 透明度变量

```scss
$overlay-light: rgba(255, 255, 255, 0.1);
$overlay-medium: rgba(255, 255, 255, 0.2);
$overlay-dark: rgba(0, 0, 0, 0.3);
```

## 2. 布局系统

### 核心布局变量

**尺寸变量**：定义在 `variables/_layout.scss`

- `$player-bar-height: 90px` - 播放器栏高度
- `$title-bar-height: 32px` - 标题栏高度
- `$sidebar-width-default: 240px` - 默认侧边栏宽度
- `$content-padding: 16px` - 内容区域内边距

**层级系统**：定义在 `variables/_colors.scss`

- `$z-sidebar: 50` - 侧边栏层级
- `$z-modal: 100` - 模态框层级
- `$z-player: 200` - 播放器层级

### 响应式混合宏

```scss
// 使用方式
@include respond-to("sm") {
	// 小屏幕样式
}
```

**断点定义**：xs(480px), sm(768px), md(1024px), lg(1200px), xl(1440px)

## 3. 组件编写规范

### 变量使用规范

```scss
// 组件样式中必须使用预定义变量
.component {
	background-color: $bg-secondary; // 使用背景色变量
	color: $text-primary; // 使用文本色变量
	padding: $content-padding; // 使用间距变量
	border-radius: $border-radius; // 使用圆角变量
	transition: all $transition-base; // 使用过渡变量
}
```

### 样式类命名规范

```scss
// 使用BEM命名方式
.song-card {              // 块(Block)
	&__cover { }          // 元素(Element)
	&__info { }
	&--current { }        // 修饰符(Modifier)
	&--disabled { }
}

// 状态类使用is-前缀
.is-active, .is-visible, .is-loading
```

### 响应式编写规范

```scss
// 必须使用预定义断点
.component {
	// 桌面优先的样式

	@include respond-to("md") {
		// 中等屏幕适配
	}

	@include respond-to("sm") {
		// 小屏幕适配
	}
}
```

## 4. Element Plus 主题定制

### Element Plus 深色主题适配

项目通过 `themes/_element-plus.scss` 文件对 Element Plus 组件进行深色主题适配。

**主要覆盖原则**：

- 使用项目定义的色彩变量（`$bg-primary`, `$text-primary` 等）
- 保持组件功能完整性，仅调整视觉样式
- 确保无障碍访问性（对比度、焦点状态等）

**覆盖范围**：按钮、输入框、对话框、下拉菜单、表格等所有使用的组件

## 5. 图标使用规范

### Font Awesome 4.7.0 组件化使用标准

项目使用基于 Font Awesome 4.7.0 的 FAIcon 组件，提供标准化的图标使用方式。

⚠️ **重要警告：FAIcon 组件样式依赖**

FAIcon 组件必须正确导入样式变量，否则会导致组件渲染失败：

```scss
// FAIcon.vue 的 <style> 块中必须包含
@use "../styles/variables/_colors" as *;
@use "../styles/variables/_layout" as *;
```

**常见错误**：缺少变量导入导致 `$transition-base` 等变量未定义，组件无法正常渲染。

#### 基础用法

```vue
<!-- 标准图标使用 -->
<FAIcon name="play" size="medium" color="primary" />

<!-- 可点击图标 -->
<FAIcon name="times" size="small" color="danger" :clickable="true" />

<!-- 带事件监听 -->
<FAIcon
	name="heart"
	size="large"
	color="accent"
	:clickable="true"
	@click="handleClick"
/>
```

#### 组件属性规范

```typescript
interface FAIconProps {
	name: string; // Font Awesome 图标名称（不含 fa- 前缀）
	size: "small" | "medium" | "large" | "xl"; // 尺寸类型
	color: "primary" | "secondary" | "accent" | "danger"; // 颜色类型
	clickable?: boolean; // 是否可点击
}
```

### 图标样式类规范

```scss
// 尺寸类（自动应用，无需手动添加）
.icon--small    // 12px（移动端：10px）
.icon--medium   // 16px（移动端：14px）
.icon--large    // 20px（移动端：18px）
.icon--xl       // 24px（移动端：22px）

// 颜色类（通过 color 属性自动应用）
.icon--primary    // 主文本色 (#ffffff)
.icon--secondary  // 次级文本色 (#b3b3b3)
.icon--accent     // 强调色 (#4caf50)
.icon--danger     // 危险色 (#f44336)

// 交互类（通过 clickable 属性自动应用）
.icon--clickable  // 可点击状态，包含悬停效果和缩放动画
.icon--disabled   // 禁用状态
.icon--loading    // 加载动画（旋转）
```

### 常用图标映射表

项目核心图标映射（基于实际使用）：

```scss
// 窗口和界面控制
close → times             // 关闭（⚠️ 重要：不是close）
minimize → minus          // 最小化
menu → bars              // 菜单

// 播放控制
play → play              // 播放
pause → pause            // 暂停
next → step-forward      // 下一首
previous → step-backward // 上一首

// 常用操作
search → search          // 搜索
edit → edit             // 编辑
delete → trash          // 删除
settings → cog          // 设置
```

### 响应式适配

图标组件自动适配移动端，在小屏幕设备上尺寸会适当缩小 2px，可点击图标具备最小触摸区域要求。

## 6. 动画规范

### 过渡时间标准

```scss
$transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1); // 快速交互
$transition-base: 0.25s cubic-bezier(0.4, 0, 0.2, 1); // 标准过渡
$transition-slow: 0.3s cubic-bezier(0.4, 0, 0.2, 1); // 页面切换
```

### Vue 过渡命名规范

```scss
// 淡入淡出
.fade-enter-active,
.fade-leave-active {
	transition: opacity $transition-base;
}

// 滑动效果
.slide-enter-active,
.slide-leave-active {
	transition: transform $transition-slow;
}
```

### 交互动画规范

```scss
// 所有可交互元素必须添加过渡
button,
.clickable {
	transition: all $transition-base;
}
```

### 滚动条样式规范

项目已全局配置统一的滚动条样式，组件无需重复定义。

## 7. 响应式规范

### 响应式使用规范

使用预定义断点和混合宏进行响应式设计，断点定义详见第 76 行。

## 8. 基础样式类规范

### 容器样式类

```scss
.container {
	padding: var(--content-padding);
	background-color: $bg-primary;
}
.card {
	background-color: $bg-secondary;
	border: 1px solid $bg-tertiary;
}
```

### 状态样式类

```scss
// 交互状态
.is-active, .is-selected, .is-current
.is-disabled, .is-loading, .is-visible

// 悬停效果
.hover-lift     // 悬停上升
.hover-scale    // 悬停缩放
```

## 9. 文件组织规范

### SCSS 文件结构

```
src-renderer/styles/
├── main.scss                 // 主样式入口，统一导入所有样式文件
├── variables.scss            // 变量转发文件，供Vue组件<style>块使用
├── variables/                // 变量定义目录
│   ├── _colors.scss          // 色彩变量（34行）
│   ├── _typography.scss      // 字体变量（38行）
│   └── _layout.scss          // 布局变量和响应式混合宏（47行）
├── base/                     // 基础样式目录
│   ├── _reset.scss           // 样式重置（108行）
│   ├── _global.scss          // 全局样式（179行）
│   └── _transitions.scss     // 动画过渡（206行）
├── components/               // 组件样式目录
│   ├── _buttons.scss         // 按钮样式（232行）
│   ├── _forms.scss           // 表单样式（278行）
│   ├── _cards.scss           // 卡片样式（351行）
│   ├── _icons.scss           // 图标样式（144行）
│   ├── _app-layout.scss      // 应用布局（103行）
│   └── _sidebar.scss         // 侧边栏样式（135行）
└── themes/                   // 主题样式目录
    ├── _dark.scss            // 深色主题（256行）
    └── _element-plus.scss    // Element Plus组件覆盖（426行）
```

### 导入顺序规范

遵循固定导入顺序：变量 → 基础 → 组件 → 主题，确保样式覆盖优先级正确。

## 10. Vue 组件与 Electron IPC 通信规范

### IPC 数据序列化要求

⚠️ **关键警告：响应式对象序列化问题**

Vue 的响应式对象（reactive、ref）不能直接传递给 Electron IPC，会导致"An object could not be cloned"错误。

#### 错误示例

```javascript
// ❌ 错误：直接传递响应式对象
const editingTags = reactive({ title: "", artist: "" });
await window.electronAPI.updateSongTags(songId, editingTags); // 报错
```

#### 正确做法

```javascript
// ✅ 正确：转换为普通对象
const plainTags = {
	title: editingTags.title,
	artist: editingTags.artist,
	album: editingTags.album,
	year: editingTags.year,
};
await window.electronAPI.updateSongTags(songId, plainTags);
```

#### 数据转换方法

1. **手动提取**：逐字段复制（推荐，类型安全）
2. **toRaw()转换**：`toRaw(reactiveObj)`（需要导入 toRaw）
3. **JSON 序列化**：`JSON.parse(JSON.stringify(obj))`（性能较差）

## 11. 编写规范检查清单

### 关键检查要点

#### 样式编写检查

- [ ] 使用预定义色彩变量而非硬编码颜色值
- [ ] 采用 BEM 命名规范，状态类使用 is-前缀
- [ ] 响应式样式使用预定义断点和混合宏
- [ ] 交互元素添加标准过渡效果

#### FAIcon 组件检查（⚠️ 重点）

- [ ] 使用 FAIcon 组件而非旧的 Icon 组件
- [ ] **必须导入样式变量**：@use "../styles/variables/\_colors" as _; @use "../styles/variables/\_layout" as _;
- [ ] 图标名称映射正确（close → times, minimize → minus）
- [ ] 尺寸使用字符串：'small', 'medium', 'large', 'xl'
- [ ] 颜色使用预定义类型：'primary', 'secondary', 'accent', 'danger'
- [ ] 可点击图标设置 :clickable="true"

#### IPC 通信检查（⚠️ 重点）

- [ ] **响应式对象转换**：不直接传递 reactive/ref 对象给 IPC
- [ ] 使用普通对象：手动提取字段或 toRaw() 转换
- [ ] IPC 调用前验证数据可序列化
- [ ] watch 监听添加错误处理和条件判断

#### 文件组织检查

- [ ] 组件样式文件引入必要的变量文件
- [ ] 遵循导入顺序：变量 → 基础 → 组件 → 主题
- [ ] 使用 variables.scss 作为 Vue 组件样式变量入口
